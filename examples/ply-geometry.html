<script src="./template.js" template="./template.html" title="ply-geometry"></script>

<style>
	body {
		background: #111;
	}
</style>

<!-- The combination of a high-intensity point light moving around to make the
points shimmer, coupled with the dark color of the points, makes a higher
contrast between dark and bright points for effect. -->

<lume-scene id="scene" perspective="800" webgl>
	<lume-point-light id="light" position="200 -200 200" intensity="6000" color="cyan" align-point="0.5 0.5">
		<!-- uncomment the sphere to visualize the light position -->
		<lume-sphere has="basic-material" color="cyan" size="10" align-point="0.5 0.5"></lume-sphere>
	</lume-point-light>

	<lume-ambient-light color="white" intensity="0.6"></lume-ambient-light>

	<lume-camera-rig active distance="200" max-distance="700" min-distance="100" align-point="0.5 0.5"></lume-camera-rig>

	<lume-points
		id="withPhong"
		visible="false"
		has="ply-geometry phong-material"
		src="./models/shelby-gt350.ply"
		rotation="90 0 0"
		position="-250 0 0"
		size="0 0 0"
		scale="50 50 50"
		color="#003333"
		align-point="0.5 0.5"
	></lume-points>

	<lume-points
		id="withoutPhong"
		visible="true"
		has="ply-geometry"
		src="./models/shelby-gt350.ply"
		rotation="90 0 0"
		position="-250 0 0"
		size="0 0 0"
		scale="50 50 50"
		color="#009999"
		align-point="0.5 0.5"
		size-attenuation
		point-size="0.5"
	></lume-points>
</lume-scene>

<div id="ui">
	<label>
		<input id="usePhong" type="checkbox" />
		Use phong material for shimmering effect (works in Firefox only)
	</label>
</div>

<style>
	#ui {
		color: white;
		position: absolute;
		top: 10px;
		left: 10px;
	}
</style>

<script type="module">
	import 'lume'

	const lightDisplacement = 100
	const movementRate = 0.002

	light.position = (x, y, z, t) => [
		-lightDisplacement * Math.cos(t * movementRate),
		lightDisplacement * Math.cos(t * movementRate),
		lightDisplacement * Math.sin(t * movementRate),
	]

	usePhong.addEventListener('input', () => {
		withPhong.visible = !!usePhong.checked
		withoutPhong.visible = !usePhong.checked
	})
</script>
